% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multivariate_pipeline.R
\name{run_multivariate_pipeline}
\alias{run_multivariate_pipeline}
\title{Multivariate Pipeline}
\usage{
run_multivariate_pipeline(
  X,
  y,
  maf,
  max_L = 30,
  ld_reference_meta_file = NULL,
  pip_cutoff_to_skip = rep(0, ncol(y)),
  signal_cutoff = 0.025,
  secondary_coverage = c(0.5, 0.7),
  mrmash_weights_prior_matrices = NULL,
  mrmash_weights_prior_matrices_cv = NULL,
  prior_canonical_matrices = TRUE,
  sample_partition = NULL,
  mrmash_max_iter = 5000,
  mvsusie_max_iter = 200,
  max_cv_variants = 5000,
  cv_folds = 5,
  cv_threads = 1,
  cv_seed = 999,
  weights_tol = 0.001,
  twas_weights = FALSE
)
}
\arguments{
\item{X}{A matrix of genotype data where rows represent samples and columns represent genetic variants.}

\item{y}{A matrix of phenotype measurements, representing samples and columns represent conditions.}

\item{maf}{A list of vectors for minor allele frequencies for each variant in X.}

\item{max_L}{The maximum number of components in mvSuSiE. Default is 30.}

\item{ld_reference_meta_file}{An optional path to a file containing linkage disequilibrium reference data. If provided, variants in X are filtered based on this reference.}

\item{pip_cutoff_to_skip}{Cutoff value for skipping conditions based on PIP values. Default is 0.}

\item{signal_cutoff}{Cutoff value for signal identification in PIP values for mvsusie_post_processor. Default is 0.025.}

\item{secondary_coverage}{A vector of secondary coverage probabilities for credible set refinement. Defaults to c(0.7, 0.5).}

\item{mrmash_weights_prior_matrices}{A list of data-driven covariance matrices for mr.mash weights.}

\item{mrmash_weights_prior_matrices_cv}{A list of data-driven covariance matrices for mr.mash weights in cross-validation.}

\item{prior_canonical_matrices}{If set to TRUE, will compute canonical covariance matrices and add them into the prior covariance matrix list in mrmash_wrapper. Default is TRUE.}

\item{sample_partition}{Sample partition for cross-validation.}

\item{mrmash_max_iter}{The maximum number of iterations for mr.mash. Default is 5000.}

\item{mvsusie_max_iter}{The maximum number of iterations for mvSuSiE. Default is 200.}

\item{max_cv_variants}{The maximum number of variants to be included in cross-validation. Defaults to 5000.}

\item{cv_folds}{The number of folds to use for cross-validation. Set to 0 to skip cross-validation. Default is 5.}

\item{cv_threads}{The number of threads to use for parallel computation in cross-validation. Defaults to 1.}

\item{cv_seed}{The seed for random number generation in cross-validation. Defaults to 999.}

\item{dropped_sample}{A list of lists with X, Y, and covar, each list contains a list of dropped samples as vectors for each condition. Can be obtained from the output of load_regional_multivariate_data.}

\item{X_scalar}{Scalar for the genotype data, used in residual scaling at the step of mvsusie_post_processor. Defaults to 1 (no scaling).}

\item{y_scalar}{Scalar for the phenotype data, used in residual scaling at the step of mvsusie_post_processor. Defaults to 1 (no scaling).}
}
\description{
This function performs weights computation for Transcriptome-Wide Association Study (TWAS) with fitting
models using mvSuSiE and mr.mash with the option of using a limited number of variants selected from
mvSuSiE fine-mapping for computing TWAS weights with cross-validation.
}
