% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dentist_qc.R
\name{dentist_detect_outliers}
\alias{dentist_detect_outliers}
\title{Detect Outliers Using Dentist Algorithm}
\usage{
dentist_detect_outliers(
  sum_stat,
  LD_mat,
  nSample,
  window_size = 2e+06,
  pValueThreshold = 5.0369e-08,
  propSVD = 0.4,
  gcControl = FALSE,
  nIter = 10,
  gPvalueThreshold = 0.05,
  ncpus = 1,
  seed = 999,
  correct_chen_et_al_bug = TRUE
)
}
\arguments{
\item{sum_stat}{A data frame containing summary statistics, including 'pos' or 'position' and 'z' or 'zscore' columns.}

\item{LD_mat}{A matrix containing LD (linkage disequilibrium) information.}

\item{nSample}{The number of samples.}

\item{window_size}{The size of the window for dividing the genomic region. Default is 2000000.}

\item{pValueThreshold}{The p-value threshold for significance. Default is 5e-8.}

\item{propSVD}{The proportion of singular value decomposition (SVD) to use. Default is 0.4.}

\item{gcControl}{Logical indicating whether genomic control should be applied. Default is FALSE.}

\item{nIter}{The number of iterations for the Dentist algorithm. Default is 10.}

\item{gPvalueThreshold}{The genomic p-value threshold for significance. Default is 0.05.}

\item{ncpus}{The number of CPU cores to use for parallel processing. Default is 1.}

\item{seed}{The random seed for reproducibility. Default is 999.}

\item{correct_chen_et_al_bug}{Logical indicating whether to correct the Chen et al. bug. Default is TRUE.}
}
\value{
A data frame containing the imputed result and detected outliers.

The returned data frame includes the following columns:

\describe{
  \item{\code{original_z}}{The original z-score values from the input \code{sum_stat}.}
  \item{\code{imputed_z}}{The imputed z-score values computed by the Dentist algorithm.}
  \item{\code{rsq}}{The coefficient of determination (R-squared) between original and imputed z-scores.}
  \item{\code{corrected_z}}{The corrected z-score values, if applicable.}
  \item{\code{iter_to_correct}}{The number of iterations required to correct the z-scores, if applicable.}
  \item{\code{index_within_window}}{The index of the observation within the window.}
  \item{\code{index_global}}{The global index of the observation.}
  \item{\code{outlier_stat}}{The computed statistical value based on the original and imputed z-scores and R-squared.}
  \item{\code{outlier}}{A logical indicator specifying whether the observation is identified as an outlier based on the statistical test.}
}
}
\description{
DENTIST (Detecting Errors iN analyses of summary staTISTics) is a quality control
tool for GWAS summary data. It uses linkage disequilibrium (LD) information from a reference
panel to identify and correct problematic variants by comparing observed GWAS statistics to
predicted values. It can detect errors in genotyping/imputation, allelic errors, and
heterogeneity between GWAS and LD reference samples.
}
\details{
# correct_chen_et_al_bug may affect the result in three parts compared with the original DENTIST method:
# 1. the way that window is divided
   when there is only one window and window size >= position range, it will run two windows
   where the first window is the whole range (e.g., 0-4122) and second is the subset of it, (e.g., 742-4122), which adds no information
   so if we set correct_chen_et_al_bug=TRUE and this is the scenario for window_size and positions, then it only runs on the whole window
   A more general description for this is:
       - if correct_chen_et_al_bug = FALSE, then there can never be a single window
       - if window_size is invalid (<=0 or >=range):
           - if correct_chen_et_al_bug==TRUE, run dentist single window, so just window (0-4122)
           - if correct_chen_et_al_bug==FALSE, run in the dentist original way, so window (0-4122) and (742-4122)
       - if window_size is valid:
           - if correct_chen_et_al_bug==TRUE, divide the window but don't add additional window if the first window covers all, so just (0-4122)
           - if correct_chen_et_al_bug==FALSE, divide the window in the dentist original way, so window (0-4122) and (742-4122)
2. comparison between iteration index t and nIter (explained in the source code)
3. !grouping_tmp (explained in the source code)
}
\examples{
# Example usage of dentist_detect_outliers
dentist_detect_outliers(sum_stat, LD_mat, nSample)

}
