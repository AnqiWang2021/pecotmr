% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/quantile_twas_weight.R
\name{check_and_remove_problematic_columns}
\alias{check_and_remove_problematic_columns}
\title{Check and Remove Problematic Columns to Ensure Full Rank}
\usage{
check_and_remove_problematic_columns(
  X,
  C,
  strategy = "variance",
  response = NULL,
  max_iterations = 100
)
}
\arguments{
\item{X}{Matrix of SNPs}

\item{C}{Matrix of covariates (unnamed)}

\item{strategy}{The strategy for removing problematic columns ("variance", "correlation", or "response_correlation")}

\item{response}{Optional response vector for "response_correlation" strategy}

\item{max_iterations}{Maximum number of iterations to attempt removing problematic columns}
}
\value{
Cleaned matrix X with problematic columns removed
}
\description{
This function checks for problematic columns in the design matrix that cause it to be not full rank,
and iteratively removes them based on the chosen strategy until the matrix is full rank.
}
